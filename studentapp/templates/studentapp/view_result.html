<!DOCTYPE html>
<html>
<head>
  <title>{{ result.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
  --bg:#f5f7fa;
  --card-bg:#ffffff;
  --accent1:#e4570a;
  --accent2:#ff8400;
  --accent3:#d4450d;
  --success:#ae6f27;
  --text:#333333;
  --light:#f8f9fa;
  --border:#e0e0e0;
  --header-bg:#f1f5f9;
  --row-hover:#f8fafc;
}

html,body{
  margin:0;
  padding:0;
  background:var(--bg);
  font-family:"Inter", "Segoe UI", Roboto, Arial, sans-serif;
  overflow-x:hidden !important;
}

/* PAGE & CARD */
.page{
  width:100%;
  padding:20px 10px;
  box-sizing:border-box;
  min-height:100vh;
}

.card{
  width:100%;
  max-width:700px;
  margin:20px auto;
  padding:24px 18px;   /* YOUR ORIGINAL PADDING */
  border-radius:16px;
  background:white;
  box-shadow:0 4px 18px rgba(0,0,0,0.15);
  overflow-x:hidden !important;
}

/* LOGO */
.logo-wrap{
  display:flex;
  justify-content:center;
  margin-bottom:20px;
  padding-bottom:14px;
  border-bottom:1px solid var(--border);
}

.logo-main{
  max-width:180px;
  width:60%;
  height:auto;
}

/* HEADER */
h2{
  text-align:center;
  font-size:1.7rem;
  font-weight:700;
  color:var(--accent1);
  margin-bottom:25px;
  position:relative;
}

h2:after{
  content:'';
  width:70px;
  height:3px;
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  position:absolute;
  bottom:-8px;
  left:50%;
  transform:translateX(-50%);
}

/* SEARCH INPUT */
.input-group{
  max-width:500px;
  margin:0 auto 25px;
}

label{
  font-weight:600;
  color:var(--accent1);
  margin-bottom:6px;
  font-size:1rem;
}

input{
  width:100%;
  padding:14px 16px;
  font-size:1rem;
  border:1.4px solid #d0d0d7;
  border-radius:10px;
  background:var(--light);
  outline:none;
}

input:focus{
  border-color:var(--accent2);
}

/* Validation message */
.error-message {
  color: #dc2626;
  font-size: 0.85rem;
  margin-top: 6px;
  display: none;
  font-weight: 500;
}

.error-message.show {
  display: block;
}

input.error {
  border-color: #dc2626;
}

/* SEARCH BUTTON */
button{
  width:100%;
  max-width:500px;
  display:block;
  margin:0 auto;
  margin-bottom:28px;
  padding:14px;
  border-radius:10px;
  background:linear-gradient(135deg,var(--accent1),var(--accent2));
  border:none;
  color:white;
  font-size:1.1rem;
  font-weight:600;
  cursor:pointer;
  transition: opacity 0.3s;
}

button:disabled{
  opacity: 0.6;
  cursor: not-allowed;
}

/* RESULTS HEADER */
.results-header{
  background:linear-gradient(135deg,var(--accent1),var(--accent2));
  color:white;
  padding:18px;
  text-align:center;
  border-radius:12px 12px 0 0;
}

/* ⭐ WRAPPER TO FIX LEFT+RIGHT GAP */
.results-wrap{
  padding:0 18px;     /* PERFECT EVEN GAP ON BOTH SIDES */
  background:white;
  border-radius:0 0 12px 12px;
  box-sizing:border-box;
}

/* TABLE */
.results-table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  word-break:break-word;
}

.results-table tr{
  border-bottom:1px solid var(--border);
}

.results-table td{
  padding:10px 10px;
  vertical-align:middle;
  font-size:0.95rem;
}

.field-name{
  width:40%;
  color:#444;
  font-weight:600;
}

.field-value{
  width:60%;
}

/* FIELD CONTENT */
.field-content{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}

.field-text{
  font-size:0.9rem;
}

.normal-value,
.rank-value,
.percentage-value,
.score-value{
  word-break:break-word;
}

/* BADGES */
.compact-badge{
  padding:4px 8px;
  border-radius:12px;
  font-size:0.8rem;
  font-weight:600;
}

.success{ background:#e7f7ef; color:#10b981; }
.warning{ background:#fff7d8; color:#d97706; }
.danger{ background:#fde2e2; color:#dc2626; }
.info{ background:#e0edff; color:#2563eb; }

/* FOOTER */
.footer-actions{
  display:flex;
  justify-content:center;
  padding:20px;
  gap: 15px;
}

.btn-danger{
  padding:12px 20px;
  background:#222;
  color:white;
  border-radius:10px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.btn-secondary {
  padding:12px 20px;
  background:#6c757d;
  color:white;
  border-radius:10px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

/* NO RESULTS */
.no-results {
  text-align: center;
  padding: 40px 20px;
  color: #666;
}

.no-results i {
  font-size: 48px;
  color: #ddd;
  margin-bottom: 15px;
}

.no-results h3 {
  color: #555;
  margin-bottom: 10px;
}

/* PRINT STYLES */
@media print {
  body * {
    visibility: hidden;
  }
  .print-container, .print-container * {
    visibility: visible;
  }
  .print-container {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    padding: 20px;
  }
  .no-print {
    display: none !important;
  }
}

/* MOBILE */
@media(max-width:600px){
  .card{
    padding:18px 12px;
  }
  .results-table td{
    padding:8px 8px;
    font-size:0.75rem;
  }
  .field-name, .field-value{
    width:50% !important;
  }
  .footer-actions {
    flex-direction: column;
    align-items: center;
  }
  .btn-danger, .btn-secondary {
    width: 100%;
    max-width: 250px;
  }
}

/* CENTER THE ENTIRE CARD */
.page {
    display: flex;
    justify-content: center;
    align-items: flex-start;   /* keeps card at top but centered horizontally */
    padding-top: 20px;
}

.card {
    width: 100%;
    max-width: 700px;
}

</style>

</head>

<body>
  <div class="page">
    <div class="card">

      <div class="logo-wrap">
        <img class="logo-main"
             src="/static/logo.png"
             onerror="this.src='https://qualitythought.in/wp-content/uploads/2025/10/1-3-2048x694.png';"
             alt="Institution Logo">
      </div>

      <h2>QT-Official Scholarship Examination Result</h2>

      <!-- Search Form -->
      <form method="GET" id="searchForm">
        <div class="input-group">
          <label><i class="fas fa-search"></i> Search by Mobile Number</label>
          <input name="q" id="mobileInput" value="{{ request.GET.q }}" 
                 placeholder="Enter 10-digit mobile number only (e.g., 9876543210)" 
                 required>
          <div class="error-message" id="mobileError">
            Please enter exactly 10 digits (numbers only)
          </div>
        </div>

        <button type="submit" id="searchBtn"><i class="fas fa-search"></i> Search Results</button>
      </form>

      <!-- Results -->
      {% if matched_record %}
      <div class="results-container">

        <div class="results-header">
          <h3>{{ result.title }} - Results</h3>
          <P> Check Your Scholarship   </P>
          
        </div>

        <!-- ⭐ WRAP TABLE FOR EQUAL SPACING -->
        <div class="results-wrap">
          <table class="results-table">
            <tbody>
              {% for key, value in matched_record.items %}
              <tr>
                <td class="field-name">
                  <div class="field-content">
                    {% if key == "Name" %}
                      <i class="fas fa-user fa-sm"></i>
                    {% elif key == "Mobile" or key == "Phone" %}
                      <i class="fas fa-phone fa-sm"></i>
                    {% elif key == "Score" or key == "Marks" %}
                      <i class="fas fa-chart-line fa-sm"></i>
                    {% elif key == "Rank" %}
                      <i class="fas fa-trophy fa-sm"></i>
                    {% elif key == "Email" %}
                      <i class="fas fa-envelope fa-sm"></i>
                    {% elif key == "Scholarship" %}
                      <i class="fas fa-award fa-sm"></i>
                    {% elif key == "Date" %}
                      <i class="fas fa-calendar-alt fa-sm"></i>
                    {% elif key == "ID" %}
                      <i class="fas fa-id-card fa-sm"></i>
                    {% else %}
                      <i class="fas fa-info-circle fa-sm"></i>
                    {% endif %}
                    <span class="field-text">{{ key }}</span>
                  </div>
                </td>

                <td class="field-value">
                  {% if key == "Status" %}
                    {% if value in "Selected Passed Qualified" %}
                      <span class="compact-badge success">{{ value }}</span>
                    {% elif value == "Pending" %}
                      <span class="compact-badge warning">{{ value }}</span>
                    {% elif value == "Failed" %}
                      <span class="compact-badge danger">{{ value }}</span>
                    {% else %}
                      <span class="compact-badge info">{{ value }}</span>
                    {% endif %}

                  {% elif key == "Rank" %}
                    <strong>#{{ value }}</strong>

                  {% elif key == "Percentage" %}
                    <strong>{{ value }}%</strong>

                  {% elif key == "Score" or key == "Marks" %}
                    <strong>{{ value }}</strong>

                  {% else %}
                    <span>{{ value }}</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="footer-actions">
          <a href="javascript:void(0);" onclick="generatePrintable()" class="btn-danger">
            <i class="fas fa-print"></i> Print Result
          </a>
        </div>

      </div>

      {% elif request.GET.q %}
      <div class="no-results">
        <i class="fas fa-search"></i>
        <h3>No Results Found</h3>
        <p>No matching records found for "<strong>{{ request.GET.q }}</strong>"</p>
      </div>

      {% endif %}
    </div>
  </div>

  <!-- Hidden Printable Container -->
  <div id="printableContainer" style="display: none;">
    <div class="print-container">
      <div style="text-align: center; margin-bottom: 20px;">
        <img src="/static/logo.png" 
             onerror="this.src='https://qualitythought.in/wp-content/uploads/2025/10/1-3-2048x694.png';"
             alt="Institution Logo" style="max-width: 200px; height: auto;">
      </div>
      <h2 style="text-align: center; color: #e4570a; margin-bottom: 20px;">
        Scholarship Results Portal - Official Result
      </h2>
      <div style="background: linear-gradient(135deg,#e4570a,#ff8400); color: white; padding: 15px; text-align: center; border-radius: 8px; margin-bottom: 20px;">
        <h3 style="margin: 0;">{{ result.title }} - Official Result</h3>
        <p style="margin: 5px 0 0 0;">Generated on: <span id="printDate"></span></p>
      </div>
      <table style="width: 100%; border-collapse: collapse;">
        <tbody id="printableTableBody">
          <!-- Dynamic content will be inserted here -->
        </tbody>
      </table>
      <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px dashed #ccc;">
        <p style="color: #666; font-size: 14px;">
          This is an official document generated by the Scholarship Results Portal.<br>
          For any queries, please contact the examination authority.
        </p>
      </div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const results = document.querySelector('.results-container');
  if (results) {
    results.style.opacity = '0';
    results.style.transform = 'translateY(20px)';
    setTimeout(() => {
      results.style.transition = '0.5s ease';
      results.style.opacity = '1';
      results.style.transform = 'translateY(0)';
    }, 100);
  }

  // Mobile number validation
  const mobileInput = document.getElementById('mobileInput');
  const mobileError = document.getElementById('mobileError');
  const searchBtn = document.getElementById('searchBtn');
  const searchForm = document.getElementById('searchForm');

  // Function to validate mobile number
  function validateMobileNumber(value) {
    // Check if it's exactly 10 digits and contains only numbers
    return /^\d{10}$/.test(value);
  }

  // Real-time validation as user types
  mobileInput.addEventListener('input', function(e) {
    let value = e.target.value;
    
    // Allow only digits
    value = value.replace(/\D/g, '');
    
    // Limit to 10 digits
    if (value.length > 10) {
      value = value.slice(0, 10);
    }
    
    // Update input value
    e.target.value = value;
    
    // Validate and update UI
    const isValid = validateMobileNumber(value);
    
    if (value && !isValid) {
      mobileError.classList.add('show');
      searchBtn.disabled = true;
      mobileInput.classList.add('error');
    } else {
      mobileError.classList.remove('show');
      searchBtn.disabled = !value || !isValid;
      mobileInput.classList.remove('error');
    }
  });

  // Form submission validation
  searchForm.addEventListener('submit', function(e) {
    const value = mobileInput.value;
    const isValid = validateMobileNumber(value);
    
    if (!isValid) {
      e.preventDefault();
      mobileError.classList.add('show');
      mobileInput.classList.add('error');
      mobileInput.focus();
    }
  });

  // Validate on page load if there's already a value
  if (mobileInput.value) {
    const value = mobileInput.value;
    const isValid = validateMobileNumber(value);
    
    if (!isValid) {
      mobileError.classList.add('show');
      searchBtn.disabled = true;
      mobileInput.classList.add('error');
    }
  }

  // Add onpaste event to handle paste action
  mobileInput.addEventListener('paste', function(e) {
    // Let the paste happen first, then validate
    setTimeout(() => {
      let value = mobileInput.value;
      
      // Clean the pasted value
      value = value.replace(/\D/g, '');
      
      // Limit to 10 digits
      if (value.length > 10) {
        value = value.slice(0, 10);
      }
      
      // Update input value
      mobileInput.value = value;
      
      // Validate
      const isValid = validateMobileNumber(value);
      
      if (value && !isValid) {
        mobileError.classList.add('show');
        searchBtn.disabled = true;
        mobileInput.classList.add('error');
      } else {
        mobileError.classList.remove('show');
        searchBtn.disabled = !value || !isValid;
        mobileInput.classList.remove('error');
      }
    }, 10);
  });
});

function generatePrintable() {
  // Get current date for the print
  const now = new Date();
  const printDate = now.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  });
  document.getElementById('printDate').textContent = printDate;
  
  // Get the table data from the visible results
  const tableRows = document.querySelectorAll('.results-table tbody tr');
  const printTableBody = document.getElementById('printableTableBody');
  printTableBody.innerHTML = '';
  
  tableRows.forEach(row => {
    const key = row.querySelector('.field-text').textContent;
    let value = '';
    
    const fieldValue = row.querySelector('.field-value');
    const badge = fieldValue.querySelector('.compact-badge');
    const strong = fieldValue.querySelector('strong');
    const span = fieldValue.querySelector('span');
    
    if (badge) {
      value = badge.textContent;
    } else if (strong) {
      value = strong.textContent;
    } else if (span) {
      value = span.textContent;
    } else {
      value = fieldValue.textContent;
    }
    
    const printRow = document.createElement('tr');
    printRow.style.borderBottom = '1px solid #eee';
    printRow.innerHTML = `
      <td style="padding: 10px; font-weight: bold; width: 40%;">${key}</td>
      <td style="padding: 10px; width: 60%;">${value}</td>
    `;
    printTableBody.appendChild(printRow);
  });
  
  // Generate print
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Print Result - Scholarship Portal</title>
      <style>
        body {
          font-family: Arial, sans-serif;
          margin: 40px;
          color: #333;
        }
        .print-container {
          max-width: 800px;
          margin: 0 auto;
          padding: 20px;
          border: 1px solid #ddd;
          border-radius: 10px;
        }
        table {
          width: 100%;
          border-collapse: collapse;
          margin: 20px 0;
        }
        td {
          padding: 12px 15px;
          border-bottom: 1px solid #eee;
        }
        @media print {
          body {
            margin: 0;
          }
          .no-print {
            display: none !important;
          }
        }
      </style>
    </head>
    <body>
      ${document.getElementById('printableContainer').innerHTML}
      <div style="text-align: center; margin-top: 20px;" class="no-print">
        <button onclick="window.print()" style="padding: 10px 20px; background: #e4570a; color: white; border: none; border-radius: 5px; cursor: pointer;">
          Print Now
        </button>
        <button onclick="window.close()" style="padding: 10px 20px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
          Close
        </button>
      </div>
    </body>
    </html>
  `);
  printWindow.document.close();
  
  // Auto-print after a short delay (optional)
  setTimeout(() => {
    printWindow.focus();
  }, 500);
}

function downloadAsPDF() {
  // This function would typically integrate with a PDF generation library
  // For now, we'll show an alert and use the print function as fallback
  alert('PDF download functionality requires server-side setup. For now, please use the Print option and save as PDF from the print dialog.');
  generatePrintable();
}
</script>

</body>
</html>